#!/usr/bin/env bats
#
# {{ ansible_managed }} [ansible-playbooks v{{ ansibleplaybooks_version }}]
#
# vim: set ts=4 sw=4 tw=0 et :

load helpers

function setup() {
	source $DIMS/bin/dims_functions.sh
}

@test "[S][EV] File /etc/nginx/conf.d/trident.conf is present" {
	[ -f /etc/nginx/conf.d/trident.conf ]
}

@test "[S][EV] Assert ownerships root:root for /etc/nginx/conf.d/trident.conf" {
	assert "root:root" stat --printf "%U:%G" /etc/nginx/conf.d/trident.conf
}

@test "[S][EV] Assert permisions 644 for /etc/nginx/conf.d/trident.conf" {
	assert 644 stat --printf "%a" /etc/nginx/conf.d/trident.conf
}

@test "[S][EV] File /etc/trident/nginx/trident-upstream.inc is present" {
	[ -f /etc/trident/nginx/trident-upstream.inc ]
}

@test "[S][EV] Assert ownerships root:root for /etc/trident/nginx/trident-upstream.inc" {
	assert "root:root" stat --printf "%U:%G" /etc/trident/nginx/trident-upstream.inc
}

@test "[S][EV] Assert permisions 644 for /etc/trident/nginx/trident-upstream.inc" {
	assert 644 stat --printf "%a" /etc/trident/nginx/trident-upstream.inc
}

@test "[S][EV] File /etc/trident/nginx/trident-server.inc is present" {
	[ -f /etc/trident/nginx/trident-server.inc ]
}

@test "[S][EV] Assert ownerships root:root for /etc/trident/nginx/trident-server.inc" {
	assert "root:root" stat --printf "%U:%G" /etc/trident/nginx/trident-server.inc
}

@test "[S][EV] Assert permisions 644 for /etc/trident/nginx/trident-server.inc" {
	assert 644 stat --printf "%a" /etc/trident/nginx/trident-server.inc
}

@test "[S][EV] Directory /etc/nginx/ssl is present" {
	[ -d /etc/nginx/ssl ]
}

@test "[S][EV] Assert ownerships root:root for /etc/nginx/ssl" {
	assert "root:root" stat --printf "%U:%G" /etc/nginx/ssl
}

@test "[S][EV] Assert permisions 755 for /etc/nginx/ssl" {
	assert 755 stat --printf "%a" /etc/nginx/ssl
}

